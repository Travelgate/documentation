"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([["79514"],{61468:function(e,r,n){n.r(r),n.d(r,{frontMatter:()=>l,toc:()=>c,default:()=>d,metadata:()=>i,assets:()=>a,contentTitle:()=>o});var i=JSON.parse('{"id":"apis/for-buyers/hotel-x-pull-buyers-api/plugins/preference","title":"Preference","description":"The Preference Plugin is a more advanced and configurable version of the Cheapest Price Plugin. While the Cheapest Price Plugin selects the lowest-priced option/s based on defined criteria, the Preference Plugin allows you to prioritize certain options over others, even if they are not the absolute cheapest.","source":"@site/docs/apis/for-buyers/hotel-x-pull-buyers-api/plugins/preference.mdx","sourceDirName":"apis/for-buyers/hotel-x-pull-buyers-api/plugins","slug":"/apis/for-buyers/hotel-x-pull-buyers-api/plugins/preference","permalink":"/docs/apis/for-buyers/hotel-x-pull-buyers-api/plugins/preference","draft":false,"unlisted":false,"editUrl":"https://github.com/Travelgate/documentation/tree/main/docs/apis/for-buyers/hotel-x-pull-buyers-api/plugins/preference.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"docsSidebar","previous":{"title":"Cheapest Price","permalink":"/docs/apis/for-buyers/hotel-x-pull-buyers-api/plugins/cheapest-price"},"next":{"title":"Add Parameter","permalink":"/docs/apis/for-buyers/hotel-x-pull-buyers-api/plugins/add-parameter"}}'),s=n(85893),t=n(50065);let l={sidebar_position:5},o="Preference",a={},c=[{value:"Preference Plugin Workflow",id:"preference-plugin-workflow",level:2},{value:"Example",id:"example",level:3},{value:"1. Create your Preference Rules on our Travelgate website",id:"1-create-your-preference-rules-on-our-travelgate-website",level:2},{value:"2. Execute Preference Plugin in your Query",id:"2-execute-preference-plugin-in-your-query",level:2},{value:"Special Aggregation Key: eqRates",id:"special-aggregation-key-eqrates",level:3}];function h(e){let r={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components},{BrowserWindow:i}=r;return i||function(e,r){throw Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("BrowserWindow",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"preference",children:"Preference"})}),"\n",(0,s.jsxs)(r.p,{children:["The ",(0,s.jsx)(r.strong,{children:"Preference Plugin"})," is a more advanced and configurable version of the ",(0,s.jsx)(r.a,{href:"/docs/apis/for-buyers/hotel-x-pull-buyers-api/plugins/cheapest-price",children:(0,s.jsx)(r.strong,{children:"Cheapest Price Plugin"})}),". While the Cheapest Price Plugin selects the lowest-priced option/s based on defined criteria, the Preference Plugin allows you to ",(0,s.jsx)(r.strong,{children:"prioritize certain options over others"}),", even if they are not the absolute cheapest."]}),"\n",(0,s.jsxs)(r.p,{children:["This is particularly useful when using ",(0,s.jsx)(r.strong,{children:"Hotel-X in multi mode"}),", where multiple suppliers may offer different prices for the same hotel, board, or room type. With the Preference Plugin, you can ",(0,s.jsx)(r.strong,{children:"set preference rules"})," that influence how results are ranked and selected."]}),"\n",(0,s.jsx)(r.p,{children:"For example, you might want to:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["Prioritize a specific supplier for certain hotels, even if their price is up to ",(0,s.jsx)(r.strong,{children:"X% higher"}),"."]}),"\n",(0,s.jsxs)(r.li,{children:["Give preference to a supplier during specific ",(0,s.jsx)(r.strong,{children:"dates or destinations"}),"."]}),"\n",(0,s.jsxs)(r.li,{children:["Customize selection rules based on ",(0,s.jsx)(r.strong,{children:"your business strategy"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["By leveraging the ",(0,s.jsx)(r.strong,{children:"Preference Plugin"}),", you gain greater control over how options are selected, allowing you to fine-tune your results based on your own ",(0,s.jsx)(r.strong,{children:"supplier relationships, pricing strategy, and business goals"}),"."]}),"\n",(0,s.jsx)(r.h2,{id:"preference-plugin-workflow",children:"Preference Plugin Workflow"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:"Gets the rules stored in database which will establish which options will be added or discarded based on several factors as % of tolerance of the price, hotel codes, supplier, etc."}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["Go over each option returned by the suppliers and if it matches any of the rules recovered from database, their price will be recalculated by multiplying it by the tolerance factor set in the rule. For example, if the factor is 10%, the new price will be 90% of the original price. This recalculation of the price is only used for aggregation purposes\u2014",(0,s.jsx)(r.strong,{children:"the final response will always return the original prices"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:"Sorts the options in price order (from cheap to expensive) by the recalculated price."}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["Take the first '",(0,s.jsx)(r.em,{children:"n"}),"' options (4 by default, configurable with the ",(0,s.jsx)(r.strong,{children:(0,s.jsx)(r.code,{children:"optionsPerKey"})})," parameter). That is, this will involve selecting the n cheapest options once the prices have been recalculated, taking the preference rules into account."]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:"There is only one exception to this, which is when a rule states that competitors must be filtered out. Thus, if any of the options meet such a rule, for that group of options, the option that filters out competitors will be the only one returned."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"example",children:"Example"}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Preference Rule Loaded:"})," Tolerance Percentage = ",(0,s.jsx)(r.strong,{children:"1%"})," for all ",(0,s.jsx)(r.strong,{children:"SUP1"})," hotels and 'filterCompetitors' is enabled."]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Scenario:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Supplier SUP1"})," offers ",(0,s.jsx)(r.strong,{children:"126\u20AC"})," for Hotel Santo Domingo (Double Room, All Inclusive)."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Supplier SUP2"})," offers ",(0,s.jsx)(r.strong,{children:"125\u20AC"})," for the same hotel and room type."]}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["By default, ",(0,s.jsx)(r.strong,{children:"SUP2 wins"})," because it has the lowest price.",(0,s.jsx)(r.br,{}),"\n","However, with the preference rule applied:"]}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["We first group all options with the same ",(0,s.jsx)(r.strong,{children:"aggregation primary key"})," (Hotel Santo Domingo - Double Room - All Inclusive)."]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["Since there is a ",(0,s.jsx)(r.strong,{children:"preference rule for SUP1 hotels"}),", we recalculate the price and internally save it like:"]}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Formula:"}),(0,s.jsx)(r.br,{}),"\n",(0,s.jsx)(r.em,{children:"Option price * (100 - tolerance%) / 100"}),(0,s.jsx)(r.br,{}),"\n","`126\u20AC * (100 - 1) / 100 = 124.74\u20AC"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["Since ",(0,s.jsx)(r.strong,{children:"124.74\u20AC is lower than 125\u20AC"})," and ",(0,s.jsx)(r.strong,{children:"'filterCompetitors' is enabled"}),", the ",(0,s.jsx)(r.strong,{children:"SUP2 option is discarded"}),", making ",(0,s.jsx)(r.strong,{children:"SUP1 the only returned option"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["If ",(0,s.jsx)(r.strong,{children:"'filterCompetitors' were disabled"}),", SUP1 would be added to the group, and ",(0,s.jsx)(r.strong,{children:"both options would be returned"})," in the results."]}),"\n",(0,s.jsx)(r.p,{children:"To get started with the Preference plugin, follow these simple steps:"}),"\n",(0,s.jsx)(r.h2,{id:"1-create-your-preference-rules-on-our-travelgate-website",children:"1. Create your Preference Rules on our Travelgate website"}),"\n",(0,s.jsxs)(r.p,{children:["Your searches will use the preference rules you create on our website in the ",(0,s.jsx)(r.strong,{children:(0,s.jsx)(r.a,{href:"https://app.travelgate.com/connections/plugins",children:"Plugins"})})," section. In this section, under the ",(0,s.jsx)(r.strong,{children:"Preference"})," tab, you\u2019ll be able to view, create, and update your rules. A rule is a set of parameters that define both a configuration and a result."]}),"\n",(0,s.jsx)(r.p,{children:"In the preference rule configuration, you must always specify the following:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"IdRule:"})," Unique identifier of the rule. You can assign any identifier that best suits you."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Suppliers:"})," List of supplier codes to which you want the rule to apply."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Context:"})," Buyer context code to which you want the rule to apply."]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"The result of the rule is made up of two manatory values:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Percentage:"})," Commission value. Percentage represents the tolerance you allow over the net price to avoid discarding the option. In other words, options that meet the criteria of this rule will not be discarded, even if they are up to X% more expensive than the cheapest option."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"FilterCompetitors:"})," true/false value. If set to true, it means that if an option exists that meets the criteria of this rule, only that option will be kept, and all others will be discarded. This ensures you only retain the option that follows the rule's criteria."]}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"2-execute-preference-plugin-in-your-query",children:"2. Execute Preference Plugin in your Query"}),"\n",(0,s.jsxs)(r.p,{children:["Once you've uploaded your preference file, to use the plugin add the following field to the ",(0,s.jsx)(r.code,{children:"settings"})," node of your request. Note that preference plugin can just be executed in search query. In order to successfully execute the preference plugin, you will need to create the request with the following variables."]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:(0,s.jsx)(r.code,{children:"step"})}),': "RESPONSE"']}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:(0,s.jsx)(r.code,{children:"type"})}),': "PRE_STEP"']}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:(0,s.jsx)(r.code,{children:"name"})}),': "preference"']}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:(0,s.jsx)(r.code,{children:"parameters"})}),":","\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:(0,s.jsx)(r.code,{children:"primaryKey"})}),': Criteria used to aggregate, separated by commas. For example: "hotel, supplier, board". Possible values are:']}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"hotel"}),"\n",(0,s.jsx)(r.li,{children:"supplier"}),"\n",(0,s.jsx)(r.li,{children:"board"}),"\n",(0,s.jsx)(r.li,{children:"binding"}),"\n",(0,s.jsx)(r.li,{children:"cancelPolicy"}),"\n",(0,s.jsx)(r.li,{children:"currency"}),"\n",(0,s.jsx)(r.li,{children:"market"}),"\n",(0,s.jsx)(r.li,{children:"payment"}),"\n",(0,s.jsx)(r.li,{children:"promotion"}),"\n",(0,s.jsx)(r.li,{children:"rateRules"}),"\n",(0,s.jsx)(r.li,{children:"refundable"}),"\n",(0,s.jsx)(r.li,{children:"room"}),"\n",(0,s.jsx)(r.li,{children:"supplement"}),"\n",(0,s.jsx)(r.li,{children:"surcharges"}),"\n",(0,s.jsx)(r.li,{children:"ratePlan"}),"\n",(0,s.jsx)(r.li,{children:"status"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:(0,s.jsx)(r.code,{children:"optionsPerKey"})}),": Limits the number of options per aggregation group, this being defined by the previous primakyKey parameter. Value: Integer. By default it is 4."]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:(0,s.jsx)(r.code,{children:"internalCurrencyConversion"})}),": Enables internal currency conversion for aggregation. Value: ",(0,s.jsx)(r.code,{children:"true"})," or ",(0,s.jsx)(r.code,{children:"false"}),". By default, aggregation considers the ",(0,s.jsx)(r.strong,{children:"currency"}),", meaning that only options sharing the same currency are grouped together. If you receive responses from multiple suppliers using different currencies but want to internally compare them, you can enable this option.  When set to ",(0,s.jsx)(r.strong,{children:(0,s.jsx)(r.code,{children:"true"})}),", Travelgate will apply an internal currency conversion (updated every day) to allow aggregation and comparison of options within the same ",(0,s.jsx)(r.code,{children:"primaryKey"})," group, even if they have different currencies. This conversion is only used for aggregation purposes\u2014",(0,s.jsx)(r.strong,{children:"the final response will always return prices in their original currency"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.admonition,{title:"Remember",type:"caution",children:(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.code,{children:"primaryKey"})," is a mandatory parameter in order to activate the plugin. ",(0,s.jsx)(r.code,{children:"optionsPerKey"})," and ",(0,s.jsx)(r.code,{children:"internalCurrencyConversion"})," are optional and complementary of the first."]})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:'"settings": {\n	"plugins": [\n		{\n			"step": "RESPONSE",\n			"pluginsType": {\n				"type": "PRE_STEP",\n				"name": "preference",\n            "parameters" : [\n                        {\n                            "key" : "primaryKey",\n                            "value" : "hotel,board,room"\n                        }\n                    ]\n			}\n		}\n	]\n}\n'})}),"\n",(0,s.jsx)(r.h3,{id:"special-aggregation-key-eqrates",children:"Special Aggregation Key: eqRates"}),"\n",(0,s.jsx)(r.p,{children:'There is a special value for the aggregation key "eqRates" that  will combine the rateRules and ratePlans of an option and group all of the options, based on the file uploaded in the SFTP with the name:'}),"\n",(0,s.jsx)(i,{children:(0,s.jsxs)(r.p,{children:["\u{1F4C1}HotelX",(0,s.jsx)(r.br,{}),"\n","\xa0\xa0\xa0\xa0 \u{1F4C1}HotelX_0000",(0,s.jsx)(r.br,{}),"\n","\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 \u{1F4C1}BusinessRules",(0,s.jsx)(r.br,{}),"\n","\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 ",(0,s.jsxs)(r.strong,{children:["\u{1F4C4}",(0,s.jsx)(r.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(45900).Z+"",children:"SupplierContext_rateplanraterule.csv"})]})]})}),"\n",(0,s.jsx)(r.p,{children:'With this uploaded CSV file, all the options with the ratePlan code "NOREEMBOLSABLE" and no rateRules will be compared with each other. Similarly, all the options without a ratePlan code or without a mapped ratePlan and with rateRules set to "NON_REFUNDABLE" will also be compared with each other.'})]})}function d(e={}){let{wrapper:r}={...(0,t.a)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},45900:function(e,r,n){n.d(r,{Z:()=>i});let i=n.p+"assets/files/SupplierContext_rateplanraterule-abb51998d01ba59f8931162b78dccf03.csv"},50065:function(e,r,n){n.d(r,{Z:()=>o,a:()=>l});var i=n(67294);let s={},t=i.createContext(s);function l(e){let r=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(t.Provider,{value:r},e.children)}}}]);